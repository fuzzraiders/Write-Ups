## HackingHub â€“ Vulnlawyers

---

![Category: Web](https://img.shields.io/badge/Category-Web-blue)
![Difficulty: Medium](https://img.shields.io/badge/Difficulty-Medium-orange)
![Platform: HackingHub](https://img.shields.io/badge/Platform-Hacking--Hub-red)

This document provides a detailed breakdown of a security assessment performed on a mock legal platform to identify and exploit web-based vulnerabilities.

This is a write-up for the Hacking Hub machine "VulnLawyers." I am presenting this walkthrough in the format of a formal Pentest Report to solidify my technical knowledge and practice professional reporting skills.

In this report, we will cover:

- Enumerating subdomains and hidden directories
- Analyzing API responses and source code for sensitive data
- Exploiting IDOR and broken access controls to escalate privileges

---

## ðŸ›  Tools

A combination of automated enumeration tools and manual browser exploitation was used to compromise the target.

```
ffuf              â†’ Fuzzing for subdomains and hidden directories
SecLists          â†’ Wordlists used for discovery and credential brute-forcing
Web Browser       â†’ Manual inspection of source code and API responses
Burp Suite/Curl   â†’ (Optional) Testing API endpoints and IDOR parameters
```

---

## Vuln Lawyers Pentest Report

- Client: VulnLawyers
- Date: July 23, 2025
- Testers: FuzzRiderss
- scope: carbon.ctfio.com (Web applications only)

## 1. Executive Summary

## This engagement simulated a real-world penetration test against VulnLawyersâ€™ web application environment.

Using openâ€‘source intelligence (OSINT), subdomain enumeration, directory bruteâ€‘forcing, and targeted authentication testing,
we identified multiple critical vulnerabilities, including IDOR and insufficient access controls,
which allowed unauthorized disclosure of user credentials and case management manipulation.
Each finding includes a detailed description, proof of concept (PoC), and remediation recommendations.

## 2. Scope

**Inâ€‘Scope Assets:**

- Main application: `carbon.ctfio.com`
- Public domain: `vulnlawyers.co.uk`
- Subdomains:
  - `api.carbon.ctfio.com`
  - `data.carbon.ctfio.com`

## **Outâ€‘ofâ€‘Scope:** Underlying infrastructure beyond DNS enumeration.

## 3. Methodology

1. **OSINT & Reconnaissance**
   - Researched public domains and DNS records.
2. **Subdomain Enumeration**
   - Utilized `ffuf` with SecLists wordlists to discover active subdomains.
3. **Directory & Endpoint Discovery**
   - Performed directory bruteâ€‘forcing against each host.
4. **Authentication Testing**
   - Inspected login workflows and POST/GET endpoints.
   - Bruteâ€‘forced credentials using `seclists` wordlists.
5. **Access Control & IDOR Testing**
   - Exploited insecure direct object references in profile endpoints.
6. **Privilege Escalation / Business Logic Abuse**
   - Leveraged valid credentials to modify or delete sensitive data.

---

## 4. Findings

### 4.1 OSINT & Subdomain Discovery

- Discovered two key subdomains:
  - `api.carbon.ctfio.com`
  - `data.carbon.ctfio.com`
- Querying API returned application metadata and a hidden flag:
  ```json
  {
    "name": "VulnLawyers Website API",
    "version": "2.1.04",
    "flag": "[^FLAG^E78DEBB***********599B0724A530^FLAG^]"
  }
  ```

> **Flag #1:** E78DEBBFDF\***\*\*\*\*\*\***36B599B0724A530

### 4.2 Directory Enumeration

| Path            | Status | Notes                                      |
| --------------- | ------ | ------------------------------------------ |
| `/css/`         | 301    | Redirects to `403 Forbidden`               |
| `/images/`      | 301    | Redirects to `403 Forbidden`               |
| `/js/`          | 301    | Redirects to `403 Forbidden`               |
| `/denied`       | 401    | Access restricted                          |
| `/login`        | 302    | Redirects to `/denied` initially           |
| `/lawyers-only` | 200    | Staff portal discovered on redirected link |

- `/login` GET revealed a hidden link and informational flag:

```html
Access to this portal can now be found here
<a href="/lawyers-only">/lawyers-only</a> Flag:
[^FLAG^FB5247*************A87252B2D4CF67^FLAG^]
```

> **Flag #2:** FB5247\***\*\*\*\*\*\*\***A87252B2D4CF67

### 4.3 User Enumeration & Authentication

- Accessed `data.carbon.ctfio.com/users` endpoint:

```json
{
  "users": [
    {
      "id": 0,
      "name": "Yusef Mcclain",
      "email": "yusef.mcclain@vulnlawyers.ctf"
    },
    {
      "id": 1,
      "name": "Shayne Cairns",
      "email": "shayne.cairns@vulnlawyers.ctf"
    },
    { "id": 2, "name": "Eisa Evans", "email": "eisa.evans@vulnlawyers.ctf" },
    {
      "id": 3,
      "name": "Jaskaran Lowe",
      "email": "jaskaran.lowe@vulnlawyers.ctf"
    },
    {
      "id": 4,
      "name": "Marsha Blankenship",
      "email": "marsha.blankenship@vulnlawyers.ctf"
    }
  ],
  "flag": "[^FLAG^25032E*************2507FBAA1A55F^FLAG^]"
}
```

> **Flag #3:** 25032EB0D322\***\*\*\*\*\*\*\***507FBAA1A55F

- Bruteâ€‘forced passwords against each email; discovered `jaskaran.lowe@vulnlawyers.ctf:summer`.
- Logged in to Jaskaranâ€™s account and retrieved first staff flag on `/lawyers-only` dashboard:

```html
Staff Portal [^FLAG^7F1ED1F306F***********4B0AE3C^FLAG^]
```

> **Flag #4:** 7F1ED1F\***\*\*\*\*\***99CEE15DF4B0AE3C

### 4.4 IDOR & Sensitive Data Exposure

- POSTing updates to `/lawyers-only-profile` appeared normal,
- but GETting `/lawyers-only-profile-details/{id}` returned cleartext passwords when changing the `id` parameter.
- Changed `id=2` to retrieve Shayne Cairnsâ€™s credentials:

```json
{
  "id": 2,
  "name": "Shayne Cairns",
  "email": "shayne.cairns@vulnlawyers.ctf",
  "password": "q2V944&#2a1^3p",
  "flag": "[^FLAG^938F5DC*************92D29A56B3^FLAG^]"
}
```

> **Flag #5:** 938F5DC109\***\*\*\*\*\*\***E3E92D29A56B3

### 4.5 Privilege Abuse & Case Deletion

- Logged in as Shayne Cairns, navigated to `Current Cases`. Authorized to delete cases.
- Deleted the `Evil Corp Vs Jones Animal Charity` case, triggering final flag:

> **Flag #6:** [^FLAG^B3***************0F10B3B5CB5^FLAG^]

---

## 5. Remediation Recommendations

1. **Implement Proper Access Controls:** Validate user authorization on each profile endpoint; ensure ID parameters are matched to authenticated user context.
2. **Encrypt Sensitive Data:** Never return plaintext passwords or sensitive fields in API responses.
3. **Secure Directory Listings:** Restrict or remove unused directories and enforce consistent response codes.
4. **Rate Limit & Monitor:** Apply bruteâ€‘force protections on authentication endpoints.
5. **Audit Logging:** Log critical actions (e.g., profile updates, case deletions) with sufficient context for forensic analysis.

---

## 6. Finally

This assessment uncovered critical flaws in access control and data exposure within VulnLawyersâ€™ staff portal.
Addressing these issues will significantly strengthen the organizationâ€™s security posture and prevent unauthorized access or data leakage.
Continuous security reviews and adherence to secure coding practices are recommended.

---

## ðŸ§  What This Challenge Teaches

- Systematic Enumeration: Using tools like ffuf to move from a single domain to hidden subdomains and portals.
- API Analysis: Understanding how to read JSON responses to find hidden metadata and user credentials.
- Exploiting Logic Flaws: Learning how IDOR (Insecure Direct Object Reference) allows an attacker to access data simply by changing an ID number.
- Privilege Escalation: Demonstrating how small leaks (like a cleartext password) can lead to full unauthorized control over business data.

## This is an excellent challenge for those looking to master **Web Application Penetration Testing fundamentals.**

## ðŸ“Œ Conclusion

The VulnLawyers machine demonstrates that a secure perimeter is only as strong as its internal access controls. By combining directory discovery with insecure API endpoints, we were able to escalate from a guest to a user capable of deleting sensitive legal cases.

Always remember:

> _Data hidden from the UI is not data hidden from the attacker. Always validate permissions on the server side._

Happy hacking ðŸš€

## Author: Z4B0

## [LinkedIn:](https://www.linkedin.com/in/mahamud-abdirahman-151493375/)
